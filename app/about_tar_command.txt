
		     GNU tar 1.11.8 + 1.5(WIN32)
			       95/11/15


1. はじめに

  GNU tar 1.11.8 + 1.5(WIN32) は GNU tar 1.11.8 を Win32 (Windows NT,
  Windows 95) に移植したものです。

  Version 1.5 では以下の機能をサポートしています。

  1) NTFS でのハードリンク

     ハードリンクされているファイルをアーカイブすると、それらのファイ
     ルのうち実体は１つだけアーカイブされ、その他のファイルはハードリ
     ンクとしてマークされます。

     展開時にはハードリンクとしてマークされているファイルは、ハードリ
     ンクのファイルとして復元されます。

     なお FATFS ではハードリンクはサポートされていないため、アーカイブ
     展開時には個別のファイルとして作成されます。

  2) 圧縮プログラムのフィルタ入出力

     GNU zip (gzip.exe) をお持ちの場合は -z オプションにより、直接、圧
     縮されたアーカイブの読み込み、作成が出来ます。

  3) ディスクドライブへの直接アクセス (Windows NT only)

     フロッピーディスクドライブ等のディスクドライブへ直接アクセスする
     ことにより tar 形式のフロッピーディスクでワークステーション等と相
     互にやり取りが出来ます。また共に GNU tar を使用する場合はマルチボ
     リューム (-M) も使用出来ますのでサイズの大きいファイルをやり取り
     する場合に便利です。

     ディスクドライブに tar 形式で直接アクセスするにはアーカイブのファ
     イル名に \\.\drive: と指定します。

     例えば a: ドライブの場合、

	tar tvf \\.\a:

     とします。

     警告: ハードディスクドライブを誤って指定して書き込みを行なった場
           合、以前の内容にはアクセス出来なくなりますのでドライブの指
	   定は十分注意してください(通常の場合ハードディスクドライブに
	   直接アクセスするには Administrator の権限が必要ですので一般
	   ユーザーで行なった場合はエラーになり大丈夫だと思いますが)。

     ここでは「直接アクセス」をディスクドライブに対してセクタ単位で読
     み書きするという意味で使用しており、直接ハードウェアを操作すると
     いう意味ではありませんので御注意を。

  4) ファイルのオーナー名とグループ名

     アーカイブ作成時にファイルのオーナー名とグループ名をアーカイブ内
     に入れるようにしています。それぞれは以下のように決定されます。

     オーナー名

       Windows NT 上で実行した場合はファイルからそのオーナー名を取得し
       ます。もしオーナー名を取得出来なかった場合は tar を実行したユー
       ザー名となり、ユーザー名を取得出来なかった場合は環境変数 USER 
       が定義されていればその値、定義されていなければ "user" となりま
       す。

       Windows 95 上ではファイルからオーナー名を取得出来ないので、tar 
       を実行したユーザー名、環境変数 USER、"user" の順に取得出来たも
       のを使用します。

     グループ名

       環境変数 GROUP が定義されていればその値が、設定されていなければ 
       "group" となります。

     アーカイブ展開時には保存されているオーナー、グループ共無視します。

  制限事項

    o  漢字のファイル名には対応していません。

    o  シンボリックリンクには対応していません。

    o  ディスクドライブに直接アクセスをする場合 -z オプションは使用出
       来ません。

    o  Windows 95 ではディスクドライブへの直接アクセスが出来ません (以
       降のバージョンで対応予定)。

    o  テープドライブには対応していません。

    o  Windows 95 でアーカイブの展開時にディレクトリのタイムスタンプを
       復元出来ません (warning message が出力される)。


2. 動作環境

  Windows NT 3.5x (コマンドプロンプト) および Windows 95 (MS-DOS プロ
  ンプト) で動作します。なおバイナリファイル・アーカイブ内の実行ファイ
  ルは Intel x86 用です。それ以外の CPU の方は別途ソースファイル・アー
  カイブを入手して各自でコンパイルしてください。

  動作チェックは以下の構成で行ないました。

	Machine	IBM PC/AT 互換機
	CPU	Intel 486DX4/100
	Cache	256kbytes
	Memory	32Mbytes
	Video	#9GXE L11 (S3 928, 2M, ISA) 1280x1024, 256色
	OS	Microsoft Windows NT Workstation 3.50 (JP, x86)
		Microsoft Windows NT Workstation 3.51 (JP, x86, Beta 1995/08)
		Microsoft Windows 95 (US)
		Microsoft Windows 95 (JP, Final Beta Release)

  tar 形式フロッピーディスクのデータ交換の確認に使用した環境

	Machine		EWS4800/360SX
	OS		R10.1 (SVR4.2MP)
	Software	GNU tar 1.11.2
	Format		720k、1.44M
			Single volume, Multi volume

  コンパイラは Microsoft Visual C++ 2.0J (x86) を使用しました。


3. コンパイル (ソースファイル・アーカイブ)

  トップディレクトリで

	nmake -f Makefile.w32 DEBUG=0

  とします (DEBUG=1 とするとデバッグバージョンがコンパイルされます)。

  win32/w32io.c で Microsoft Visual C++ 固有の内部関数を使用しています。
  この関数は OS のエラーコードを errno にマッピングするもので、もし他
  のコンパイラを使用する場合はこの関数と同等のものを用意する必要があり
  ます。

  win32/link.c、win32/stat.c は Win32 subsystem で NTFS のハードリンク
  を利用する上で参考になると思います。


4. 使用上の注意

  いかなる場合においても、本プログラムを使用した際に貴方に損害が生じて
  も作者は一切責任を負わないものとします。また、本プログラムに不備があっ
  ても作者はそれを修正する義務を負いません。


5. 配布

  GNU General Public License に従います。
  詳しくは付属の COPYING をご覧ください。


6. 最後に

  バグ等ありましたら下記まで御連絡ください。出来る対処したいと思います。

                                             三浦 重喜 (Shigeki Miura)
                                     Internet  miura@rpts.cl.nec.co.jp
                                    小桜町BBS  しげ
                                    MARIO-NET  shigeki (しげ)
		     GNU tar 1.11.8 + 1.5(WIN32)
			       95/11/15


1. はじめに

  GNU tar 1.11.8 + 1.5(WIN32) は GNU tar 1.11.8 を Win32 (Windows NT,
  Windows 95) に移植したものです。

  Version 1.5 では以下の機能をサポートしています。

  1) NTFS でのハードリンク

     ハードリンクされているファイルをアーカイブすると、それらのファイ
     ルのうち実体は１つだけアーカイブされ、その他のファイルはハードリ
     ンクとしてマークされます。

     展開時にはハードリンクとしてマークされているファイルは、ハードリ
     ンクのファイルとして復元されます。

     なお FATFS ではハードリンクはサポートされていないため、アーカイブ
     展開時には個別のファイルとして作成されます。

  2) 圧縮プログラムのフィルタ入出力

     GNU zip (gzip.exe) をお持ちの場合は -z オプションにより、直接、圧
     縮されたアーカイブの読み込み、作成が出来ます。

  3) ディスクドライブへの直接アクセス (Windows NT only)

     フロッピーディスクドライブ等のディスクドライブへ直接アクセスする
     ことにより tar 形式のフロッピーディスクでワークステーション等と相
     互にやり取りが出来ます。また共に GNU tar を使用する場合はマルチボ
     リューム (-M) も使用出来ますのでサイズの大きいファイルをやり取り
     する場合に便利です。

     ディスクドライブに tar 形式で直接アクセスするにはアーカイブのファ
     イル名に \\.\drive: と指定します。

     例えば a: ドライブの場合、

	tar tvf \\.\a:

     とします。

     警告: ハードディスクドライブを誤って指定して書き込みを行なった場
           合、以前の内容にはアクセス出来なくなりますのでドライブの指
	   定は十分注意してください(通常の場合ハードディスクドライブに
	   直接アクセスするには Administrator の権限が必要ですので一般
	   ユーザーで行なった場合はエラーになり大丈夫だと思いますが)。

     ここでは「直接アクセス」をディスクドライブに対してセクタ単位で読
     み書きするという意味で使用しており、直接ハードウェアを操作すると
     いう意味ではありませんので御注意を。

  4) ファイルのオーナー名とグループ名

     アーカイブ作成時にファイルのオーナー名とグループ名をアーカイブ内
     に入れるようにしています。それぞれは以下のように決定されます。

     オーナー名

       Windows NT 上で実行した場合はファイルからそのオーナー名を取得し
       ます。もしオーナー名を取得出来なかった場合は tar を実行したユー
       ザー名となり、ユーザー名を取得出来なかった場合は環境変数 USER 
       が定義されていればその値、定義されていなければ "user" となりま
       す。

       Windows 95 上ではファイルからオーナー名を取得出来ないので、tar 
       を実行したユーザー名、環境変数 USER、"user" の順に取得出来たも
       のを使用します。

     グループ名

       環境変数 GROUP が定義されていればその値が、設定されていなければ 
       "group" となります。

     アーカイブ展開時には保存されているオーナー、グループ共無視します。

  制限事項

    o  漢字のファイル名には対応していません。

    o  シンボリックリンクには対応していません。

    o  ディスクドライブに直接アクセスをする場合 -z オプションは使用出
       来ません。

    o  Windows 95 ではディスクドライブへの直接アクセスが出来ません (以
       降のバージョンで対応予定)。

    o  テープドライブには対応していません。

    o  Windows 95 でアーカイブの展開時にディレクトリのタイムスタンプを
       復元出来ません (warning message が出力される)。


2. 動作環境

  Windows NT 3.5x (コマンドプロンプト) および Windows 95 (MS-DOS プロ
  ンプト) で動作します。なおバイナリファイル・アーカイブ内の実行ファイ
  ルは Intel x86 用です。それ以外の CPU の方は別途ソースファイル・アー
  カイブを入手して各自でコンパイルしてください。

  動作チェックは以下の構成で行ないました。

	Machine	IBM PC/AT 互換機
	CPU	Intel 486DX4/100
	Cache	256kbytes
	Memory	32Mbytes
	Video	#9GXE L11 (S3 928, 2M, ISA) 1280x1024, 256色
	OS	Microsoft Windows NT Workstation 3.50 (JP, x86)
		Microsoft Windows NT Workstation 3.51 (JP, x86, Beta 1995/08)
		Microsoft Windows 95 (US)
		Microsoft Windows 95 (JP, Final Beta Release)

  tar 形式フロッピーディスクのデータ交換の確認に使用した環境

	Machine		EWS4800/360SX
	OS		R10.1 (SVR4.2MP)
	Software	GNU tar 1.11.2
	Format		720k、1.44M
			Single volume, Multi volume

  コンパイラは Microsoft Visual C++ 2.0J (x86) を使用しました。


3. コンパイル (ソースファイル・アーカイブ)

  トップディレクトリで

	nmake -f Makefile.w32 DEBUG=0

  とします (DEBUG=1 とするとデバッグバージョンがコンパイルされます)。

  win32/w32io.c で Microsoft Visual C++ 固有の内部関数を使用しています。
  この関数は OS のエラーコードを errno にマッピングするもので、もし他
  のコンパイラを使用する場合はこの関数と同等のものを用意する必要があり
  ます。

  win32/link.c、win32/stat.c は Win32 subsystem で NTFS のハードリンク
  を利用する上で参考になると思います。


4. 使用上の注意

  いかなる場合においても、本プログラムを使用した際に貴方に損害が生じて
  も作者は一切責任を負わないものとします。また、本プログラムに不備があっ
  ても作者はそれを修正する義務を負いません。


5. 配布

  GNU General Public License に従います。
  詳しくは付属の COPYING をご覧ください。


6. 最後に

  バグ等ありましたら下記まで御連絡ください。出来る対処したいと思います。

                                             三浦 重喜 (Shigeki Miura)
                                     Internet  miura@rpts.cl.nec.co.jp
                                    小桜町BBS  しげ
                                    MARIO-NET  shigeki (しげ)



                          GNU tar 1.11.8 + 2.2(WIN32)

三浦 重喜 (Shigeki Miura) さんによる、GNU tar 1.11.8 + 1.5(WIN32) に
trivial な付加機能を付けたものです。Microsoft VC++ で Make して
あります。tar.pdf はマニュアルです。付加機能は

(1) 異なるドライブに対する -C オプションが使用不可だったのを
    使用可能にした。
    tar zxvf foo.tar.gz -C d:/bar/baz
    などとできるようになった。
(2) 圧縮フィルタとして、gzip に加えて bzip2 を使えるようにした。
    オプション文字は j を採用してある。長い形式では --bzip2 である。
    従って例えば
    tar jcf foo.tar.bz2 bar  とか
    tar jxvf foo.tar.bz2 -C d:/bar/baz
    などとできる。

(3) 圧縮フィルタとして、gzip, bzip2 に加えて lzma を使えるようにした。
    オプション文字は Y を採用してある。長い形式では --lzma である。
    従って例えば
    tar Ycf foo.tar.lzma bar  とか
    tar Yxvf foo.tar.lzma -C d:/bar/baz
    などとできる。

(4) 圧縮フィルタとして、gzip, bzip2, lzma に加えて xz を使えるようにした。
    オプション文字は J を採用してある。長い形式では --xz である。
    従って例えば
    tar Jcf foo.tar.xz bar  とか
    tar Jxvf foo.tar.xz -C d:/bar/baz
    などとできる。

(5) 1.5 では long name に関して、oldgnu 形式しか使用できなかったが、
    2.1 では posix header を使う ustar 形式のファイルも読むことができる。
    ただし作成に関しては、oldgnu 形式のものを作成する。

(6) 2.1 では、圧縮フィルタをアーカイブ拡張子で決めることができる。
    つまり、デフォルト拡張子 ".gz", ".tgz", ".Z", ".bz2", ".lzma", ".xz"
    を使えば、オプション文字 z, j, Y, J を省略できる。
    圧縮フィルタの決定は最初のものが使用され、後で指定したものは無視される。
    従って
    tar xvf a.tar.xz --gzip
    は矛盾しているけれども、エラーにはならず、xz が使用される。一方
    tar zxvf a.tar.xz
    最初に gzip に決定されるので、矛盾していてエラーになる。

(7) 2.2 では Pax extended header を部分的にサポートしている。この種の
    アーカイブを読み取ることができる。ただし作成に関しては，oldgnu 形式
    のものを作成する。Global Pax header は無視される。

となっています。
-----------------------
Akira Kakuto
